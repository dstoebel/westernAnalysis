---
title: "Western blot analysis"
output: html_notebook
---
These notes are written for Stoebel Lab quantification of RpoS blots. You may need to work with Dan to modify the standards or code below for your specific work. In particular the code was written with one independent variable in mind. (I.e. one strain at many time points, one strain at many RpoS levels, or many strains at one time point.) If you've got something more complicated, we can modify things.

##Setting up your data

For **each** western blot, create a folder. The folder name should include the date that the blot was done on, and it should match the date entry in your lab notebook so that we can go back and doublecheck specifics of the experiment. This folder should contain the following: 

1. A .tif file of the blot, with no added marks to it. This should be grayscale, with background in white and bands in black.

2. A .tif file of the image, showing the boxes used for quantification of band intensities.

3. A .tif file of the revert stained membrane, with no added marks to it. This should be grayscale, with background in white and bands in black.

4. A .tif file of the revert stained membrane, showing the boxes used for quantification of band intensities.

5. A Keynote file with the image of the blot (#1 above) labeling all lanes, strain numbers, experimental conditions, etc. Do not use PowerPoint, which often downsamples the resolution of images. If you do not have Keynote on your computer, you are welcome to use the lab iMac.

6. The Excel file of exported RpoS band intesities. If you also quantified another protein, do not include them in this file. In this spreadsheet, define a column named "Lane". In this column, label each signal with the lane it came from. This is so that the protein signal will be matched up with the correct lane signal from the imaging of the REVERT staining. Define the lane (or rectangle around the protein band) containing from the ladder as 1. All other lanes/rectangles should be numbered according to what lane they are in. This is because the "Name" column that is generated by Image Studio may not correspond between the total protein blot spreadsheet data and the single band of protein blot spreadsheet data. In addition to "Lane", add other columns to define the variables that are important for your experiment (I.e. strain #, species, muations, growth time point, OD, % arabinose added, %RpoS, etc.)

7. The Excel file of exported Revert stain intensities or RpoD band intensities, if you used this method. You should add the "Lane" column, exactly as above. You don't need to add the other information, as the samples will be matched up by the script. 

Start by importing the data
```{r}
library(tidyverse)
library(readxl)
theme_set(theme_minimal())

normalizationData <- read_excel("wbQuantification/sampleData/revertStatJan23.xls")
rpoSData <- read_excel("wbQuantification/sampleData/stationaryJan23.xls")

```

Normalize all data by Revert levels

```{r}
source("westernHelperFunctions.R") #This loads the helper functions for normalization, etc.

#calling the function in order to get the normalized signal for every set of Western blots

blotData <- normalizeSingleBlot(normalizationData, rpoSData)
```


##Plot the data

The exact plot you need to do will depend on the specifics of your experiment. Here is an example from this experiment.

```{r}

blotData$`Strain Name` <- factor(blotData$`Strain Name`, levels = blotData$`Strain Name`) #Makes strain name a factor, with the levels in the order given in the origional file, which was useful for this experiment.

ggplot(blotData) + geom_col(aes(x = `Strain Name`, y = RpoSratio)) + theme(plot.subtitle = element_text(vjust = 1), 
    plot.caption = element_text(vjust = 1), 
    axis.text.x = element_text(angle = 90))
```
This plot of the sample data shows right away some expected results (the two âˆ†rpoS strains are near zero, as expected) and one very unexpected result (what does a negative value for K. pneumoniae mean?). 

In addition to visually inspecting the blot image, checking an appropriate plot makes sure that quantification worked as expected. (Or in this sample case, didn't work properly for all strains.) 

